<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title></title>
  <style type="text/css">
    * {
      margin: 0;
      padding: 0;
    }
    *{
      list-style: none;
    }
    #box{
      height:600px;
      width:600px;
      margin: auto;
    }
    li{
      float:left;
      border: 1px solid #000;
    }
    h1{
      display: inline-block;
    }
  </style>
</head>
<body>
<h1></h1>
<div id="box">

  <ul></ul>
</div>
</body>
<script type="text/javascript">
  window.onload = function () {
      let box=document.getElementById('box');
      let ullist=document.querySelector('ul');
      let h=document.querySelector('h1');
      h.innerHTML='第1关';
      //创建一个num作为li个数的增量
      let num=1;
      //创建一个num作为透明度的增量
      let  sum=5;
      let b=0;
      let a=0;
      //创建一个数组存储生成的颜色
      let aqa=[];
      //生成颜色
      function rgba(){
        let a= parseInt(Math.random()*255);
        let b= parseInt(Math.random()*255);
        let g= parseInt(Math.random()*255);
        return a+','+b+','+g
      }
      //把生成的颜色添加到数组中
      for(let j=0;j<100;j++){
        aqa.push(rgba())
      }
      //创建li
      chuang();
      function chuang(){
        sum=sum+5/20;
        if(sum==12){
          alert('game over');
          ullist.innerHTML='';
        }
        for(let i=0;i<num*num;i++){
          let li=document.createElement('li');
          li.style.height=(box.offsetHeight-num*2)/num+'px';
          li.style.width=(box.offsetWidth-num*2)/num+'px';
          li.style.backgroundColor='rgba('+aqa[a]+')';
          ullist.appendChild(li);
        }
        a++;
        num++;
        if(num>=14){
          num=14
        }
        bian();
        www();
      };
      //随机一个改变透明度
      function bian(){
        let lilist=document.querySelectorAll('li');
        lilist[parseInt(Math.random()*(lilist.length-1))].style.opacity=sum/10;
      }
      //添加点击事件
      function www(){
        let list=document.querySelectorAll('li');
        for(let i=0;i<list.length;i++){
          list[i].onclick=function(){
            if(this.style.opacity==sum/10){
              b++;
              h.innerHTML='第'+b+'关'
              run();
            }
          }
        }
      }
      //删除前边的li创建新的
      function run(){
        let li=document.querySelectorAll('li');
        ullist.innerHTML='';
        chuang();
      }
  }
</script>
</html>
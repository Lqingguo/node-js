<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title></title>

  <style type="text/css">
    * {
      margin: 0;
      padding: 0;
    }

  </style>
</head>
<body>
<input type="text"><button id="btn">点击获取验证码</button>
</body>
<script type="text/javascript">
      let lasttime=0;
      let sum=null;
      document.getElementById('btn').onclick=function (){
        let newtime= Date.now();
        if(newtime - lasttime <=5000) return;
        lasttime=newtime;
        let num=5;
        this.innerText=`请${num}秒后重试`;
        this.style.color='gray';

         const timers=setInterval(()=> {
          this.innerText=`请${--num}秒后重试`;
          if(num<0){
            this.innerText=`点击获取`;
            this.style.color='black';
            clearInterval(timers);
          }
        },1000);
         if(sum){;,[]
           sum.abort();
         }else {
           ajaxend('GET','http://localhost:3000/text?username=xiaoming')
         }
         function ajaxend(stend,url){
           const xhr =new  XMLHttpRequest();
           xhr.onreadystatechange=function(){
             if(xhr.readyState ===4 && xhr.status===200){
               console.log(xhr.responseText);
               sum=null;
             }
           };
           xhr.open(stend,url);
           xhr.send();
         }

      }

</script>
</html>